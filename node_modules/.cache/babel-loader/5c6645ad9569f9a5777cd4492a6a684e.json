{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/muyangguo/Desktop/webgl/WebglPrototype/cybergraph/src/ThreeViewer.js\";\nimport React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport * as THREE from \"three\";\nimport { OrbitControls } from \"./OrbitControls.js\";\nimport allQuestions from \"./data/all.json\";\n\nclass ThreeView extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.onMouseMove = event => {\n      // calculate mouse position in normalized device coordinates\n      // (-1 to +1) for both components\n      event.preventDefault();\n      this.mouse.x = event.clientX / window.innerWidth * 2 - 1;\n      this.mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n      this.raycaster.setFromCamera(this.mouse, this.camera); // calculate objects intersecting the picking ray\n\n      const intersects = this.raycaster.intersectObjects(this.cubesToBePicked);\n\n      if (intersects.length > 0) {\n        // if the closest object intersected is not the currently stored intersection object\n        if (intersects[0].object != this.INTERSECTED) {\n          // restore previous intersection object (if it exists) to its original color\n          if (this.INTERSECTED) this.INTERSECTED.material.color.setHex(this.INTERSECTED.currentHex); // store reference to closest object as current intersection object\n\n          this.INTERSECTED = intersects[0].object; // store color of closest object (for later restoration)\n\n          this.INTERSECTED.currentHex = this.INTERSECTED.material.color.getHex(); // set a new color for closest object\n\n          this.INTERSECTED.material.color.setHex(0xFF00FF);\n        }\n      } else // there are no intersections\n        {\n          // restore previous intersection object (if it exists) to its original color\n          if (this.INTERSECTED) {\n            this.INTERSECTED.material.color.setHex(this.INTERSECTED.currentHex);\n          } // remove previous intersection object reference\n          //     by setting current intersection object to \"nothing\"\n\n\n          this.INTERSECTED = null;\n        } // this.frameId = window.requestAnimationFrame(this.animate);\n\n    };\n\n    this.onWindowResize = () => {\n      this.camera.aspect = window.innerWidth / window.innerHeight;\n      this.camera.updateProjectionMatrix();\n      this.renderer.setSize(window.innerWidth, window.innerHeight);\n    };\n\n    this.renderScene = () => {\n      // mouse and raycaster\n      this.raycaster.setFromCamera(this.mouse, this.camera); // calculate objects intersecting the picking ray\n\n      const intersects = this.raycaster.intersectObjects(this.cubesToBePicked);\n\n      if (intersects.length > 0) {\n        if (intersects[0].object != this.INTERSECTED) {\n          if (this.INTERSECTED) this.INTERSECTED.material.color.setHex(this.INTERSECTED.currentHex);\n          this.INTERSECTED = intersects[0].object;\n          this.INTERSECTED.currentHex = this.INTERSECTED.material.color.getHex();\n          this.INTERSECTED.material.color.setHex(0xFF00FF);\n        }\n      } else {\n        if (this.INTERSECTED) {\n          this.INTERSECTED.material.color.setHex(this.INTERSECTED.currentHex);\n        }\n\n        this.INTERSECTED = null;\n      } // this.frameId = window.requestAnimationFrame(this.animate);\n\n\n      window.requestAnimationFrame(this.renderScene); // if (this.renderer) this.renderer.render(this.scene, this.camera);\n\n      this.renderer.render(this.scene, this.camera);\n    };\n  }\n\n  componentDidMount() {\n    this.scene = new THREE.Scene(); //Add Renderer\n\n    this.renderer = new THREE.WebGLRenderer({\n      antialias: true\n    });\n    this.renderer.setSize(window.innerWidth, window.innerWidth);\n    window.addEventListener(\"resize\", this.onWindowResize, false);\n    this.mount.appendChild(this.renderer.domElement); //add Camera\n\n    this.camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 10000);\n    this.camera.position.set(0, 2000, 1500);\n    this.raycaster = new THREE.Raycaster();\n    this.mouse = new THREE.Vector2(); //Camera Controls\n\n    this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n    this.INTERSECTED = null;\n    this.cubesToBePicked = [];\n    this.addModels();\n    this.renderScene(); // this.start();\n  }\n\n  addModels() {\n    var worldsize = 6000;\n    this.plane = new THREE.Mesh(new THREE.PlaneGeometry(worldsize, worldsize, 1), new THREE.MeshBasicMaterial({\n      color: \"grey\",\n      opacity: 0.3,\n      transparent: true\n    }));\n    this.plane.rotation.set(-Math.PI / 2, 0, 0);\n    this.scene.add(this.plane); //grid\n\n    var size = 3000,\n        step = 40;\n    var geometry, material;\n\n    for (let i = -size; i <= size; i += step) {\n      if (i / step % 2 === 0) {\n        continue;\n      }\n\n      geometry = new THREE.Geometry();\n      material = new THREE.LineBasicMaterial({\n        color: \"purple\"\n      });\n      geometry.vertices.push(new THREE.Vector3(-size, 0, i));\n      geometry.vertices.push(new THREE.Vector3(size, 0, i));\n      this.line = new THREE.LineSegments(geometry, material);\n      this.scene.add(this.line);\n    }\n\n    for (let i = -size; i <= size; i += step) {\n      if (i / step % 2 === 0) {\n        continue;\n      }\n\n      geometry = new THREE.Geometry();\n      material = new THREE.LineBasicMaterial({\n        color: \"green\"\n      });\n      geometry.vertices.push(new THREE.Vector3(i, 0, -size));\n      geometry.vertices.push(new THREE.Vector3(i, 0, size));\n      this.line = new THREE.LineSegments(geometry, material);\n      this.scene.add(this.line);\n    }\n\n    var offset = 2000,\n        side = 50,\n        sidegap = 80;\n\n    for (let i = 0; i < allQuestions.length; i += 1) {\n      var questionIndex = Number(allQuestions[i][\"id\"]) - 1;\n      var bottommaterial;\n\n      if (allQuestions[i][\"difficulty\"] === \"1\") {\n        bottommaterial = new THREE.MeshBasicMaterial({\n          color: 0x00cc00\n        });\n      } else if (allQuestions[i][\"difficulty\"] === \"2\") {\n        bottommaterial = new THREE.MeshBasicMaterial({\n          color: 0xff9900\n        });\n      } else {\n        bottommaterial = new THREE.MeshBasicMaterial({\n          color: 0xD63333\n        });\n      }\n\n      var bottomgeometry = new THREE.BoxGeometry(60, 20, 60);\n      var row = Math.floor(questionIndex / side);\n      var col = questionIndex % side;\n      bottomgeometry.translate(col * sidegap - offset, 10, row * sidegap - offset);\n      this.bottommesh = new THREE.Mesh(bottomgeometry, bottommaterial);\n      this.scene.add(this.bottommesh);\n      this.cubesToBePicked.push(this.bottommesh);\n      window.addEventListener('mousemove', this.onMouseMove, false);\n    }\n  }\n\n  componentWillUnmount() {\n    this.mount.removeChild(this.renderer.domElement);\n  } //   start = () => {\n  //     if (!this.frameId) {\n  //       this.frameId = requestAnimationFrame(this.animate);\n  //     }\n  //   };\n  //   stop = () => {\n  //     cancelAnimationFrame(this.frameId);\n  //   };\n\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mount => {\n        this.mount = mount;\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default ThreeView;","map":{"version":3,"sources":["/Users/muyangguo/Desktop/webgl/WebglPrototype/cybergraph/src/ThreeViewer.js"],"names":["React","Component","ReactDOM","THREE","OrbitControls","allQuestions","ThreeView","onMouseMove","event","preventDefault","mouse","x","clientX","window","innerWidth","y","clientY","innerHeight","raycaster","setFromCamera","camera","intersects","intersectObjects","cubesToBePicked","length","object","INTERSECTED","material","color","setHex","currentHex","getHex","onWindowResize","aspect","updateProjectionMatrix","renderer","setSize","renderScene","requestAnimationFrame","render","scene","componentDidMount","Scene","WebGLRenderer","antialias","addEventListener","mount","appendChild","domElement","PerspectiveCamera","position","set","Raycaster","Vector2","controls","addModels","worldsize","plane","Mesh","PlaneGeometry","MeshBasicMaterial","opacity","transparent","rotation","Math","PI","add","size","step","geometry","i","Geometry","LineBasicMaterial","vertices","push","Vector3","line","LineSegments","offset","side","sidegap","questionIndex","Number","bottommaterial","bottomgeometry","BoxGeometry","row","floor","col","translate","bottommesh","componentWillUnmount","removeChild"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,aAAT,QAA8B,oBAA9B;AACA,OAAOC,YAAP,MAAyB,iBAAzB;;AAEA,MAAMC,SAAN,SAAwBL,SAAxB,CAAkC;AAAA;AAAA;;AAAA,SAC9BM,WAD8B,GACfC,KAAD,IAAU;AACxB;AACA;AACAA,MAAAA,KAAK,CAACC,cAAN;AACA,WAAKC,KAAL,CAAWC,CAAX,GAAiBH,KAAK,CAACI,OAAN,GAAgBC,MAAM,CAACC,UAAzB,GAAwC,CAAxC,GAA4C,CAA3D;AACA,WAAKJ,KAAL,CAAWK,CAAX,GAAe,EAAGP,KAAK,CAACQ,OAAN,GAAgBH,MAAM,CAACI,WAA1B,IAA0C,CAA1C,GAA8C,CAA7D;AACA,WAAKC,SAAL,CAAeC,aAAf,CAA8B,KAAKT,KAAnC,EAA0C,KAAKU,MAA/C,EANwB,CAOxB;;AACA,YAAMC,UAAU,GAAG,KAAKH,SAAL,CAAeI,gBAAf,CAAiC,KAAKC,eAAtC,CAAnB;;AACA,UAAKF,UAAU,CAACG,MAAX,GAAoB,CAAzB,EACA;AACI;AACA,YAAKH,UAAU,CAAE,CAAF,CAAV,CAAgBI,MAAhB,IAA0B,KAAKC,WAApC,EACA;AACI;AACA,cAAK,KAAKA,WAAV,EACI,KAAKA,WAAL,CAAiBC,QAAjB,CAA0BC,KAA1B,CAAgCC,MAAhC,CAAwC,KAAKH,WAAL,CAAiBI,UAAzD,EAHR,CAII;;AACA,eAAKJ,WAAL,GAAmBL,UAAU,CAAE,CAAF,CAAV,CAAgBI,MAAnC,CALJ,CAMI;;AACA,eAAKC,WAAL,CAAiBI,UAAjB,GAA8B,KAAKJ,WAAL,CAAiBC,QAAjB,CAA0BC,KAA1B,CAAgCG,MAAhC,EAA9B,CAPJ,CAQI;;AACA,eAAKL,WAAL,CAAiBC,QAAjB,CAA0BC,KAA1B,CAAgCC,MAAhC,CAAwC,QAAxC;AAEH;AAEJ,OAjBD,MAkBK;AACL;AACI;AACA,cAAK,KAAKH,WAAV,EAAuB;AACnB,iBAAKA,WAAL,CAAiBC,QAAjB,CAA0BC,KAA1B,CAAgCC,MAAhC,CAAwC,KAAKH,WAAL,CAAiBI,UAAzD;AACD,WAJP,CAKI;AACA;;;AAEA,eAAKJ,WAAL,GAAmB,IAAnB;AAEH,SAtCuB,CAuCxB;;AAGC,KA3C6B;;AAAA,SA4ChCM,cA5CgC,GA4Cf,MAAM;AACrB,WAAKZ,MAAL,CAAYa,MAAZ,GAAqBpB,MAAM,CAACC,UAAP,GAAoBD,MAAM,CAACI,WAAhD;AACA,WAAKG,MAAL,CAAYc,sBAAZ;AACA,WAAKC,QAAL,CAAcC,OAAd,CAAsBvB,MAAM,CAACC,UAA7B,EAAyCD,MAAM,CAACI,WAAhD;AACD,KAhD+B;;AAAA,SAoLhCoB,WApLgC,GAoLlB,MAAM;AAClB;AAEA,WAAKnB,SAAL,CAAeC,aAAf,CAA8B,KAAKT,KAAnC,EAA0C,KAAKU,MAA/C,EAHkB,CAIlB;;AACA,YAAMC,UAAU,GAAG,KAAKH,SAAL,CAAeI,gBAAf,CAAiC,KAAKC,eAAtC,CAAnB;;AACA,UAAKF,UAAU,CAACG,MAAX,GAAoB,CAAzB,EACA;AACI,YAAKH,UAAU,CAAE,CAAF,CAAV,CAAgBI,MAAhB,IAA0B,KAAKC,WAApC,EACA;AACI,cAAK,KAAKA,WAAV,EACI,KAAKA,WAAL,CAAiBC,QAAjB,CAA0BC,KAA1B,CAAgCC,MAAhC,CAAwC,KAAKH,WAAL,CAAiBI,UAAzD;AACJ,eAAKJ,WAAL,GAAmBL,UAAU,CAAE,CAAF,CAAV,CAAgBI,MAAnC;AACA,eAAKC,WAAL,CAAiBI,UAAjB,GAA8B,KAAKJ,WAAL,CAAiBC,QAAjB,CAA0BC,KAA1B,CAAgCG,MAAhC,EAA9B;AACA,eAAKL,WAAL,CAAiBC,QAAjB,CAA0BC,KAA1B,CAAgCC,MAAhC,CAAwC,QAAxC;AACH;AACJ,OAVD,MAYA;AACI,YAAK,KAAKH,WAAV,EAAuB;AACnB,eAAKA,WAAL,CAAiBC,QAAjB,CAA0BC,KAA1B,CAAgCC,MAAhC,CAAwC,KAAKH,WAAL,CAAiBI,UAAzD;AACD;;AACH,aAAKJ,WAAL,GAAmB,IAAnB;AACH,OAvBiB,CAyBlB;;;AAEAb,MAAAA,MAAM,CAACyB,qBAAP,CAA6B,KAAKD,WAAlC,EA3BkB,CA6BlB;;AACA,WAAKF,QAAL,CAAcI,MAAd,CAAqB,KAAKC,KAA1B,EAAiC,KAAKpB,MAAtC;AAGD,KArN+B;AAAA;;AAkDhCqB,EAAAA,iBAAiB,GAAG;AAElB,SAAKD,KAAL,GAAa,IAAIrC,KAAK,CAACuC,KAAV,EAAb,CAFkB,CAGlB;;AACA,SAAKP,QAAL,GAAgB,IAAIhC,KAAK,CAACwC,aAAV,CAAwB;AAAEC,MAAAA,SAAS,EAAE;AAAb,KAAxB,CAAhB;AACA,SAAKT,QAAL,CAAcC,OAAd,CAAsBvB,MAAM,CAACC,UAA7B,EAAyCD,MAAM,CAACC,UAAhD;AACAD,IAAAA,MAAM,CAACgC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKb,cAAvC,EAAuD,KAAvD;AACA,SAAKc,KAAL,CAAWC,WAAX,CAAuB,KAAKZ,QAAL,CAAca,UAArC,EAPkB,CASlB;;AACA,SAAK5B,MAAL,GAAc,IAAIjB,KAAK,CAAC8C,iBAAV,CACV,EADU,EAEVpC,MAAM,CAACC,UAAP,GAAoBD,MAAM,CAACI,WAFjB,EAGV,CAHU,EAIV,KAJU,CAAd;AAMA,SAAKG,MAAL,CAAY8B,QAAZ,CAAqBC,GAArB,CAAyB,CAAzB,EAA4B,IAA5B,EAAkC,IAAlC;AACA,SAAKjC,SAAL,GAAiB,IAAIf,KAAK,CAACiD,SAAV,EAAjB;AACA,SAAK1C,KAAL,GAAa,IAAIP,KAAK,CAACkD,OAAV,EAAb,CAlBkB,CAqBlB;;AACA,SAAKC,QAAL,GAAgB,IAAIlD,aAAJ,CAAkB,KAAKgB,MAAvB,EAA+B,KAAKe,QAAL,CAAca,UAA7C,CAAhB;AAIA,SAAKtB,WAAL,GAAmB,IAAnB;AACA,SAAKH,eAAL,GAAuB,EAAvB;AAEA,SAAKgC,SAAL;AACA,SAAKlB,WAAL,GA9BkB,CA+BlB;AACD;;AAEDkB,EAAAA,SAAS,GAAG;AAEV,QAAIC,SAAS,GAAG,IAAhB;AACA,SAAKC,KAAL,GAAa,IAAItD,KAAK,CAACuD,IAAV,CACT,IAAIvD,KAAK,CAACwD,aAAV,CAAwBH,SAAxB,EAAmCA,SAAnC,EAA8C,CAA9C,CADS,EAET,IAAIrD,KAAK,CAACyD,iBAAV,CAA4B;AAC1BhC,MAAAA,KAAK,EAAE,MADmB;AAE1BiC,MAAAA,OAAO,EAAE,GAFiB;AAG1BC,MAAAA,WAAW,EAAE;AAHa,KAA5B,CAFS,CAAb;AAQE,SAAKL,KAAL,CAAWM,QAAX,CAAoBZ,GAApB,CAAwB,CAACa,IAAI,CAACC,EAAN,GAAW,CAAnC,EAAsC,CAAtC,EAAyC,CAAzC;AACA,SAAKzB,KAAL,CAAW0B,GAAX,CAAe,KAAKT,KAApB,EAZQ,CAaR;;AACA,QAAIU,IAAI,GAAG,IAAX;AAAA,QACEC,IAAI,GAAG,EADT;AAEA,QAAIC,QAAJ,EAAc1C,QAAd;;AACA,SAAK,IAAI2C,CAAC,GAAG,CAACH,IAAd,EAAoBG,CAAC,IAAIH,IAAzB,EAA+BG,CAAC,IAAIF,IAApC,EAA0C;AACxC,UAAKE,CAAC,GAAGF,IAAL,GAAa,CAAb,KAAmB,CAAvB,EAA0B;AACxB;AACD;;AACDC,MAAAA,QAAQ,GAAG,IAAIlE,KAAK,CAACoE,QAAV,EAAX;AACA5C,MAAAA,QAAQ,GAAG,IAAIxB,KAAK,CAACqE,iBAAV,CAA4B;AACrC5C,QAAAA,KAAK,EAAE;AAD8B,OAA5B,CAAX;AAGAyC,MAAAA,QAAQ,CAACI,QAAT,CAAkBC,IAAlB,CAAuB,IAAIvE,KAAK,CAACwE,OAAV,CAAkB,CAACR,IAAnB,EAAyB,CAAzB,EAA4BG,CAA5B,CAAvB;AACAD,MAAAA,QAAQ,CAACI,QAAT,CAAkBC,IAAlB,CAAuB,IAAIvE,KAAK,CAACwE,OAAV,CAAkBR,IAAlB,EAAwB,CAAxB,EAA2BG,CAA3B,CAAvB;AACA,WAAKM,IAAL,GAAY,IAAIzE,KAAK,CAAC0E,YAAV,CAAuBR,QAAvB,EAAiC1C,QAAjC,CAAZ;AACA,WAAKa,KAAL,CAAW0B,GAAX,CAAe,KAAKU,IAApB;AACD;;AACD,SAAK,IAAIN,CAAC,GAAG,CAACH,IAAd,EAAoBG,CAAC,IAAIH,IAAzB,EAA+BG,CAAC,IAAIF,IAApC,EAA0C;AACxC,UAAKE,CAAC,GAAGF,IAAL,GAAa,CAAb,KAAmB,CAAvB,EAA0B;AACxB;AACD;;AACDC,MAAAA,QAAQ,GAAG,IAAIlE,KAAK,CAACoE,QAAV,EAAX;AACA5C,MAAAA,QAAQ,GAAG,IAAIxB,KAAK,CAACqE,iBAAV,CAA4B;AACrC5C,QAAAA,KAAK,EAAE;AAD8B,OAA5B,CAAX;AAGAyC,MAAAA,QAAQ,CAACI,QAAT,CAAkBC,IAAlB,CAAuB,IAAIvE,KAAK,CAACwE,OAAV,CAAkBL,CAAlB,EAAqB,CAArB,EAAwB,CAACH,IAAzB,CAAvB;AACAE,MAAAA,QAAQ,CAACI,QAAT,CAAkBC,IAAlB,CAAuB,IAAIvE,KAAK,CAACwE,OAAV,CAAkBL,CAAlB,EAAqB,CAArB,EAAwBH,IAAxB,CAAvB;AACA,WAAKS,IAAL,GAAY,IAAIzE,KAAK,CAAC0E,YAAV,CAAuBR,QAAvB,EAAiC1C,QAAjC,CAAZ;AACA,WAAKa,KAAL,CAAW0B,GAAX,CAAe,KAAKU,IAApB;AACD;;AACD,QAAIE,MAAM,GAAG,IAAb;AAAA,QACAC,IAAI,GAAG,EADP;AAAA,QAEAC,OAAO,GAAG,EAFV;;AAGF,SAAK,IAAIV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjE,YAAY,CAACmB,MAAjC,EAAyC8C,CAAC,IAAI,CAA9C,EAAiD;AAC/C,UAAIW,aAAa,GAAGC,MAAM,CAAC7E,YAAY,CAACiE,CAAD,CAAZ,CAAgB,IAAhB,CAAD,CAAN,GAAgC,CAApD;AACA,UAAIa,cAAJ;;AACA,UAAI9E,YAAY,CAACiE,CAAD,CAAZ,CAAgB,YAAhB,MAAkC,GAAtC,EAA2C;AACzCa,QAAAA,cAAc,GAAG,IAAIhF,KAAK,CAACyD,iBAAV,CAA4B;AAAEhC,UAAAA,KAAK,EAAE;AAAT,SAA5B,CAAjB;AACD,OAFD,MAEO,IAAIvB,YAAY,CAACiE,CAAD,CAAZ,CAAgB,YAAhB,MAAkC,GAAtC,EAA2C;AAChDa,QAAAA,cAAc,GAAG,IAAIhF,KAAK,CAACyD,iBAAV,CAA4B;AAAEhC,UAAAA,KAAK,EAAE;AAAT,SAA5B,CAAjB;AACD,OAFM,MAEA;AACLuD,QAAAA,cAAc,GAAG,IAAIhF,KAAK,CAACyD,iBAAV,CAA4B;AAAEhC,UAAAA,KAAK,EAAE;AAAT,SAA5B,CAAjB;AACD;;AACD,UAAIwD,cAAc,GAAG,IAAIjF,KAAK,CAACkF,WAAV,CAAsB,EAAtB,EAA0B,EAA1B,EAA8B,EAA9B,CAArB;AACA,UAAIC,GAAG,GAAGtB,IAAI,CAACuB,KAAL,CAAWN,aAAa,GAAGF,IAA3B,CAAV;AACA,UAAIS,GAAG,GAAGP,aAAa,GAAGF,IAA1B;AACAK,MAAAA,cAAc,CAACK,SAAf,CACED,GAAG,GAAGR,OAAN,GAAgBF,MADlB,EAEE,EAFF,EAGEQ,GAAG,GAAGN,OAAN,GAAgBF,MAHlB;AAKA,WAAKY,UAAL,GAAkB,IAAIvF,KAAK,CAACuD,IAAV,CAAe0B,cAAf,EAA+BD,cAA/B,CAAlB;AACA,WAAK3C,KAAL,CAAW0B,GAAX,CAAe,KAAKwB,UAApB;AACA,WAAKnE,eAAL,CAAqBmD,IAArB,CAA0B,KAAKgB,UAA/B;AACA7E,MAAAA,MAAM,CAACgC,gBAAP,CAAyB,WAAzB,EAAsC,KAAKtC,WAA3C,EAAwD,KAAxD;AAID;AAGF;;AAIDoF,EAAAA,oBAAoB,GAAG;AACrB,SAAK7C,KAAL,CAAW8C,WAAX,CAAuB,KAAKzD,QAAL,CAAca,UAArC;AAED,GArK+B,CAsKlC;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;;;AAwCET,EAAAA,MAAM,GAAG;AACP,wBACE;AACE,MAAA,GAAG,EAAEO,KAAK,IAAI;AACZ,aAAKA,KAAL,GAAaA,KAAb;AACD;AAHH;AAAA;AAAA;AAAA;AAAA,YADF;AAOD;;AA/N+B;;AAiOlC,eAAexC,SAAf","sourcesContent":["import React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport * as THREE from \"three\";\nimport { OrbitControls } from \"./OrbitControls.js\";\nimport allQuestions from \"./data/all.json\";\n\nclass ThreeView extends Component {\n    onMouseMove = (event) =>{\n    // calculate mouse position in normalized device coordinates\n    // (-1 to +1) for both components\n    event.preventDefault();\n    this.mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;\n    this.mouse.y = - (event.clientY / window.innerHeight ) * 2 + 1;\n    this.raycaster.setFromCamera( this.mouse, this.camera );\n    // calculate objects intersecting the picking ray\n    const intersects = this.raycaster.intersectObjects( this.cubesToBePicked );\n    if ( intersects.length > 0 )\n    {\n        // if the closest object intersected is not the currently stored intersection object\n        if ( intersects[ 0 ].object != this.INTERSECTED )\n        {\n            // restore previous intersection object (if it exists) to its original color\n            if ( this.INTERSECTED )\n                this.INTERSECTED.material.color.setHex( this.INTERSECTED.currentHex );\n            // store reference to closest object as current intersection object\n            this.INTERSECTED = intersects[ 0 ].object;\n            // store color of closest object (for later restoration)\n            this.INTERSECTED.currentHex = this.INTERSECTED.material.color.getHex();\n            // set a new color for closest object\n            this.INTERSECTED.material.color.setHex( 0xFF00FF );\n\n        }\n\n    }\n    else // there are no intersections\n    {\n        // restore previous intersection object (if it exists) to its original color\n        if ( this.INTERSECTED ){\n            this.INTERSECTED.material.color.setHex( this.INTERSECTED.currentHex );\n          }\n        // remove previous intersection object reference\n        //     by setting current intersection object to \"nothing\"\n        \n        this.INTERSECTED = null;\n    \n    }\n    // this.frameId = window.requestAnimationFrame(this.animate);\n\n    \n    }\n  onWindowResize = () => {\n    this.camera.aspect = window.innerWidth / window.innerHeight;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n  }\n\n  componentDidMount() {\n    \n    this.scene = new THREE.Scene();\n    //Add Renderer\n    this.renderer = new THREE.WebGLRenderer({ antialias: true });\n    this.renderer.setSize(window.innerWidth, window.innerWidth);\n    window.addEventListener(\"resize\", this.onWindowResize, false);\n    this.mount.appendChild(this.renderer.domElement);\n\n    //add Camera\n    this.camera = new THREE.PerspectiveCamera(\n        45,\n        window.innerWidth / window.innerHeight,\n        1,\n        10000\n      );\n    this.camera.position.set(0, 2000, 1500);\n    this.raycaster = new THREE.Raycaster();\n    this.mouse = new THREE.Vector2();\n\n\n    //Camera Controls\n    this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n\n\n    \n    this.INTERSECTED = null;\t\n    this.cubesToBePicked = [];\n    \n    this.addModels();\n    this.renderScene();\n    // this.start();\n  }\n  \n  addModels() {\n \n    var worldsize = 6000;\n    this.plane = new THREE.Mesh(\n        new THREE.PlaneGeometry(worldsize, worldsize, 1),\n        new THREE.MeshBasicMaterial({\n          color: \"grey\",\n          opacity: 0.3,\n          transparent: true,\n        })\n      );\n      this.plane.rotation.set(-Math.PI / 2, 0, 0);\n      this.scene.add(this.plane);\n      //grid\n      var size = 3000,\n        step = 40;\n      var geometry, material;\n      for (let i = -size; i <= size; i += step) {\n        if ((i / step) % 2 === 0) {\n          continue;\n        }\n        geometry = new THREE.Geometry();\n        material = new THREE.LineBasicMaterial({\n          color: \"purple\",\n        });\n        geometry.vertices.push(new THREE.Vector3(-size, 0, i));\n        geometry.vertices.push(new THREE.Vector3(size, 0, i));\n        this.line = new THREE.LineSegments(geometry, material);\n        this.scene.add(this.line);\n      }\n      for (let i = -size; i <= size; i += step) {\n        if ((i / step) % 2 === 0) {\n          continue;\n        }\n        geometry = new THREE.Geometry();\n        material = new THREE.LineBasicMaterial({\n          color: \"green\",\n        });\n        geometry.vertices.push(new THREE.Vector3(i, 0, -size));\n        geometry.vertices.push(new THREE.Vector3(i, 0, size));\n        this.line = new THREE.LineSegments(geometry, material);\n        this.scene.add(this.line);\n      }\n      var offset = 2000,\n      side = 50,\n      sidegap = 80;\n    for (let i = 0; i < allQuestions.length; i += 1) {\n      var questionIndex = Number(allQuestions[i][\"id\"]) - 1;\n      var bottommaterial;\n      if (allQuestions[i][\"difficulty\"] === \"1\") {\n        bottommaterial = new THREE.MeshBasicMaterial({ color: 0x00cc00 });\n      } else if (allQuestions[i][\"difficulty\"] === \"2\") {\n        bottommaterial = new THREE.MeshBasicMaterial({ color: 0xff9900 });\n      } else {\n        bottommaterial = new THREE.MeshBasicMaterial({ color: 0xD63333 });\n      }\n      var bottomgeometry = new THREE.BoxGeometry(60, 20, 60);\n      var row = Math.floor(questionIndex / side);\n      var col = questionIndex % side;\n      bottomgeometry.translate(\n        col * sidegap - offset,\n        10,\n        row * sidegap - offset\n      );\n      this.bottommesh = new THREE.Mesh(bottomgeometry, bottommaterial);\n      this.scene.add(this.bottommesh);\n      this.cubesToBePicked.push(this.bottommesh);\n      window.addEventListener( 'mousemove', this.onMouseMove, false );\n      \n    \n      \n    }\n\n\n  }\n\n\n\n  componentWillUnmount() {\n    this.mount.removeChild(this.renderer.domElement);\n \n  }\n//   start = () => {\n//     if (!this.frameId) {\n//       this.frameId = requestAnimationFrame(this.animate);\n//     }\n//   };\n\n\n//   stop = () => {\n//     cancelAnimationFrame(this.frameId);\n//   };\n\n\n\n\n  renderScene = () => {\n    // mouse and raycaster\n    \n    this.raycaster.setFromCamera( this.mouse, this.camera );\n    // calculate objects intersecting the picking ray\n    const intersects = this.raycaster.intersectObjects( this.cubesToBePicked );\n    if ( intersects.length > 0 )\n    {\n        if ( intersects[ 0 ].object != this.INTERSECTED )\n        {\n            if ( this.INTERSECTED )\n                this.INTERSECTED.material.color.setHex( this.INTERSECTED.currentHex );\n            this.INTERSECTED = intersects[ 0 ].object;\n            this.INTERSECTED.currentHex = this.INTERSECTED.material.color.getHex();\n            this.INTERSECTED.material.color.setHex( 0xFF00FF );\n        }\n    }\n    else \n    {\n        if ( this.INTERSECTED ){\n            this.INTERSECTED.material.color.setHex( this.INTERSECTED.currentHex );\n          }\n        this.INTERSECTED = null;\n    }\n\n    // this.frameId = window.requestAnimationFrame(this.animate);\n\n    window.requestAnimationFrame(this.renderScene);\n\n    // if (this.renderer) this.renderer.render(this.scene, this.camera);\n    this.renderer.render(this.scene, this.camera);\n    \n\n  };\n\n  render() {\n    return (\n      <div\n        ref={mount => {\n          this.mount = mount;\n        }}\n      />\n    );\n  }\n}\nexport default ThreeView;"]},"metadata":{},"sourceType":"module"}